#!/bin/bash

# auxiliary function to print out usage help
function drm_usage()
{
    cat <<EOF
Docker "rotating machines" manager.

Usage: ${0} [<command>] [options]

Commands:

  buid                        create new Docker image for
                              "rotating machine"

  start                       create new Docker container

  reset-defaults              restore configuration of custom scripts

Options: (the following options apply if there is no command specified)

  --help                      print this help

  --version                   print version

  Each command accepts its own specific options. See command-specific
  help for more information.
EOF
}

# at least one parameter is required
if [ ${#} -lt 1 ]; then
  drm_usage
  exit 1
fi

# parameter (default) values
drm_command=

# parse arguments
if echo ${1} | grep "^--help" > /dev/null 2> /dev/null; then
  drm_usage
  exit 0
fi
if echo ${1} | grep "^--version" > /dev/null 2> /dev/null; then
  echo "drm v0.2.0"
  exit 0
fi
drm_command=${1}
shift

# determine script path
drm_path=`dirname "${0}"`

# export script working directory
drm_wd="`echo ${0} | sed -n '/\//{s/\/[^\/]*$//;p;}'`"
drm_wd="`(cd "${drm_wd}/..";pwd)`"
export drm_wd

# call specified script
eval "${drm_path}/../usr/libexec/drm-${drm_command} ${@}"


# vim: set ts=2 sw=2 et:


